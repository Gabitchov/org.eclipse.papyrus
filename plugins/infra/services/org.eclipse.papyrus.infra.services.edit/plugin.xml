<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<!--
 Copyright (c) 2010, 2014 CEA and others.
 
 All rights reserved. This program and the accompanying materials
 are made available under the terms of the Eclipse Public License v1.0
 which accompanies this distribution, and is available at
 http://www.eclipse.org/legal/epl-v10.html
 
 Contributors:
   CEA - Initial API and implementation
   Christian W. Damus (CEA) - bug 323802
   
-->
<plugin>

<extension point="org.eclipse.gmf.runtime.emf.type.core.elementTypeBindings">
	
	<!-- Papyrus single IClientContext declaration
	     This context can only be used explicitely as its matcher always return false ( in order
	     to avoid undesired activation and possible side effects)
	  -->
	<clientContext id="org.eclipse.papyrus.infra.services.edit.TypeContext">
		<matcher class="org.eclipse.papyrus.infra.services.edit.internal.matcher.NoContextEnablementMatcher"/>
	</clientContext>

</extension>

<!-- Binds general (non-UML specific) advices

     The notation dependant advice add a View deletion command for any View that references
     the EObject currently destroyed.
     
     Both the following advices are commonly used by GMF Runtime (and code generated by the tooling):
     - org.eclipse.gmf.runtime.diagram.core.advice.notationDepdendents
     - org.eclipse.gmf.runtime.diagram.core.advice.removeBookmarks
     
     The cross referencer is used to find any View referencing and EObject, as far as the Notation file 
     is loaded (does not mean each diagram is opened), every view related to an element will be deleted
     with the element deletion. These views may possibly be located in different diagrams.
     
     These advices are generally always added to the GMF default context. As the use of the extensible 
     type framework in Papyrus is currently used with an explicit unique context, it is important 
     to add these advices to this shared context to ensure the views are correctly deleted.
     
  -->
<extension point="org.eclipse.gmf.runtime.emf.type.core.elementTypeBindings">

	<!-- Bindings declaration -->
	<binding context="org.eclipse.papyrus.infra.services.edit.TypeContext">
		
		<!-- ElementType that deals with View deletion when their related model element is deleted -->
		<elementType ref="org.eclipse.gmf.runtime.diagram.core.advice.notationDepdendents"/>
		<elementType ref="org.eclipse.gmf.runtime.diagram.core.advice.removeBookmarks"/>

        <!-- Check for attempts to edit read-only objects that cannot reasonably be made writeable. -->		
        <advice ref="org.eclipse.papyrus.infra.emf.readOnlyAdvice" />
	</binding>

</extension>

<!-- Declaration of the IElementEditServiceProvider (Papyrus wrapper to the Extensible type framework) -->
<extension point="org.eclipse.papyrus.infra.core.service">

	<serviceFactory
		id="org.eclipse.papyrus.infra.services.edit.service.IElementEditServiceProvider"
		classname="org.eclipse.papyrus.infra.services.edit.internal.ElementEditServiceProviderFactory" 
		priority="1" startKind="startup">
 	</serviceFactory>

</extension>
   
   
</plugin>
